<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Config Generator for Netlify</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #0f172a;
            color: #e2e8f0;
        }
        h1 { color: #38bdf8; }
        h2 { color: #94a3b8; margin-top: 30px; }
        .step {
            background: #1e293b;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #38bdf8;
        }
        input, textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #334155;
            border: 1px solid #475569;
            color: #e2e8f0;
            border-radius: 4px;
            font-family: monospace;
        }
        button {
            background: #38bdf8;
            color: #0f172a;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 10px 10px 0;
        }
        button:hover { background: #0284c7; }
        .success {
            background: #16a34a;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        .warning {
            background: #dc2626;
            color: white;
            padding: 10px;
            border-radius: 4px;
        }
        a {
            color: #38bdf8;
            text-decoration: none;
        }
        a:hover { text-decoration: underline; }
        code {
            background: #334155;
            padding: 2px 6px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>üî• Firebase Setup for Geriatrics Platform</h1>
    
    <div class="step">
        <h2>Step 1: Create Firebase Project</h2>
        <p>First, let's set up your Firebase project:</p>
        <button onclick="window.open('https://console.firebase.google.com/', '_blank')">
            Open Firebase Console ‚Üí
        </button>
        <ol>
            <li>Click "Create a project"</li>
            <li>Name it: <code>geriatrics-platform</code></li>
            <li>Disable Google Analytics (optional)</li>
            <li>Create project</li>
        </ol>
    </div>

    <div class="step">
        <h2>Step 2: Enable Services</h2>
        <p>In your Firebase project:</p>
        <ol>
            <li><strong>Firestore:</strong> Build ‚Üí Firestore Database ‚Üí Create database ‚Üí Start in production mode</li>
            <li><strong>Authentication:</strong> Build ‚Üí Authentication ‚Üí Get started ‚Üí Sign-in method ‚Üí Enable "Anonymous"</li>
        </ol>
    </div>

    <div class="step">
        <h2>Step 3: Get Your Configuration</h2>
        <p>Go to ‚öôÔ∏è Project settings ‚Üí Your apps ‚Üí Add app ‚Üí Web (</>) ‚Üí Register app</p>
        <p>Then paste your Firebase config object here:</p>
        <textarea id="firebaseConfig" rows="10" placeholder="const firebaseConfig = {
  apiKey: &quot;AIzaSy...&quot;,
  authDomain: &quot;your-app.firebaseapp.com&quot;,
  projectId: &quot;your-project-id&quot;,
  storageBucket: &quot;your-app.appspot.com&quot;,
  messagingSenderId: &quot;123456789&quot;,
  appId: &quot;1:123456789:web:abc123...&quot;
};"></textarea>
        <button onclick="processConfig()">Generate Netlify Config</button>
    </div>

    <div class="step" id="outputSection" style="display: none;">
        <h2>Step 4: Add to Netlify</h2>
        <p>Copy this value for your Netlify environment variable:</p>
        <p><strong>Variable Name:</strong> <code>VITE_FIREBASE_CONFIG</code></p>
        <p><strong>Variable Value:</strong></p>
        <textarea id="netlifyConfig" rows="3" readonly onclick="this.select()"></textarea>
        <button onclick="copyToClipboard()">üìã Copy to Clipboard</button>
        <button onclick="window.open('https://app.netlify.com/sites/geriatrics/settings/env', '_blank')">
            Open Netlify Settings ‚Üí
        </button>
        <div id="successMsg" class="success">‚úì Copied to clipboard!</div>
    </div>

    <div class="step" id="rulesSection" style="display: none;">
        <h2>Step 5: Update Firestore Security Rules</h2>
        <p>Go to Firestore Database ‚Üí Rules and replace with:</p>
        <textarea rows="10" readonly onclick="this.select()">rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Allow authenticated users to read/write their own data
    match /artifacts/{appId}/users/{userId}/{document=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}</textarea>
        <button onclick="window.open('https://console.firebase.google.com/project/_/firestore/rules', '_blank')">
            Open Firestore Rules ‚Üí
        </button>
    </div>

    <div class="step" id="deploySection" style="display: none;">
        <h2>Step 6: Redeploy Your Site</h2>
        <p>After adding the environment variable to Netlify:</p>
        <button onclick="window.open('https://app.netlify.com/sites/geriatrics/deploys', '_blank')">
            Go to Netlify Deploys ‚Üí
        </button>
        <p>Click "Trigger deploy" ‚Üí "Deploy site"</p>
        <br>
        <p><strong>üéâ Your app will be ready at:</strong></p>
        <a href="https://geriatrics.netlify.app" target="_blank" style="font-size: 20px;">
            https://geriatrics.netlify.app
        </a>
    </div>

    <script>
        function processConfig() {
            const input = document.getElementById('firebaseConfig').value;
            
            try {
                // Extract the config object from the input
                let configStr = input;
                
                // Remove 'const firebaseConfig = ' if present
                configStr = configStr.replace(/const\s+\w+\s*=\s*/, '');
                
                // Remove trailing semicolon if present
                configStr = configStr.replace(/;\s*$/, '');
                
                // Try to parse as JSON first
                let configObj;
                try {
                    configObj = JSON.parse(configStr);
                } catch {
                    // If not valid JSON, try to evaluate as JavaScript object
                    configStr = configStr.replace(/(\w+):/g, '"$1":');
                    configStr = configStr.replace(/'/g, '"');
                    configObj = JSON.parse(configStr);
                }
                
                // Validate required fields
                const required = ['apiKey', 'authDomain', 'projectId', 'storageBucket', 'messagingSenderId', 'appId'];
                for (const field of required) {
                    if (!configObj[field]) {
                        throw new Error(`Missing required field: ${field}`);
                    }
                }
                
                // Convert to JSON string for Netlify
                const netlifyValue = JSON.stringify(configObj);
                
                document.getElementById('netlifyConfig').value = netlifyValue;
                document.getElementById('outputSection').style.display = 'block';
                document.getElementById('rulesSection').style.display = 'block';
                document.getElementById('deploySection').style.display = 'block';
                
            } catch (error) {
                alert('Error processing config: ' + error.message + '\n\nPlease make sure you copied the entire firebaseConfig object from Firebase Console.');
            }
        }
        
        function copyToClipboard() {
            const textarea = document.getElementById('netlifyConfig');
            textarea.select();
            document.execCommand('copy');
            
            const msg = document.getElementById('successMsg');
            msg.style.display = 'block';
            setTimeout(() => msg.style.display = 'none', 3000);
        }
    </script>
</body>
</html>